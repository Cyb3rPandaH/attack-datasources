name: WMI object
definition: Information about objects from the system classes, such as filters and consumers, that support Windows Management Instrumentation activitites.
collection_layers:
  - host
platforms:
  - Windows
contributors: 
  - ATT&CK
  - CTID
data_components:
  - name: wmi provider
    type: information
    description: The name of the provider executable/DLL used to carry out EventConsumer actions.
  - name: wmi object context 
    type: information
    description: General information around WMI.
    relationships:
      - source_data_element: wmi subscription #TBD - delete this or move it to its own component?
        relationship: created
        target_data_element:
  - name: wmi object creation
    type: activity
    description: The creation of new WMI objects on an endpoint.
    relationships:
      - source_data_element: user
        relationship: created
        target_data_element: wmi filter
      - source_data_element: user
        relationship: created
        target_data_element: wmi consumer
      - source_data_element: user
        relationship: created
        target_data_element: wmi subscription
      - source_data_element: user
        relationship: created
        target_data_element: wmi binding
  - name: wmi object deletion
    type: activity
    description: The deletion of existing WMI objects on an endpoint.
    relationships:
      - source_data_element: user
        relationship: deleted
        target_data_element: wmi filter
      - source_data_element: user
        relationship: deleted
        target_data_element: wmi consumer
      - source_data_element: user
        relationship: deleted
        target_data_element: wmi subscription
      - source_data_element: user
        relationship: deleted
        target_data_element: wmi binding
references:
  - https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmi-system-classes

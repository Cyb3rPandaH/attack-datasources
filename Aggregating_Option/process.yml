name: Process
definition: Information about instances of computer programs that are being executed by at least one thread.
collection_layers:
  - host
platforms:
  - Windows
  - Linux
  - MacOS
contributors: 
  - ATT&CK
  - CTID
data_components:
  - name: process open files
    type: information
    description: The list of files opened by a process.
  - name: process open pipes
    type: information
    description: The list of pipes opened by a process.
  - name: process environment variables
    type: information
    description: The set of environment variables defined for a process.
  - name: process execution
    type: information
    description: Information about the execution of a process, such as the API calls that it makes.
    relationships:
      - source_data_element: process
        relationship: executes
        target_data_element: api call
      - source_data_element: process
        relationship: executes
        target_data_element: system call
  - name: process context #TBD - delete this or move it to its own component?
    type: information
    description: General information about a process.
    relationships:
      - source_data_element: process
        relationship: terminated 
        target_data_element: 
  - name: process creation
    description: The creation of a new process.
    type: activity
    relationships:
      - source_data_element: user
        relationship: created
        target_data_element: process
      - source_data_element: process
        relationship: created
        target_data_element: process
      - source_data_element: process
        relationship: created
        target_data_element: thread
      - source_data_element: process
        relationship: created
        target_data_element: remote thread
  - name: process termination
    description: The termination of an existing process.
    type: activity
    relationships:
      - source_data_element: user
        relationship: terminated
        target_data_element: process
  - name: process modification
    description: The modification of an existing process.
    type: activity
    relationships:
      - source_data_element: process
        relationship: wrote to
        target_data_element: process
  - name: process access
    description: A process opens or accesses another process.
    type: activity
    relationships:
      - source_data_element: process
        relationship: accessed
        target_data_element: process
      - source_data_element: process
        relationship: requested access
        target_data_element: process
      - source_data_element: process
        relationship: opened handle #TBD - how to specify platform-specific relationships?
        target_data_element: process
  - name: process network connection
    type: activity
    description: Information about network connections initiated by processes.
    relationships:
      - source_data_element: process
        relationship: connected to
        target_data_element: port
      - source_data_element: process
        relationship: connected to
        target_data_element: ip
      - source_data_element: process
        relationship: connected to
        target_data_element: host
      - source_data_element: process
        relationship: connected from
        target_data_element: port
      - source_data_element: process
        relationship: connected from
        target_data_element: ip
      - source_data_element: process
        relationship: connected from
        target_data_element: host
      - source_data_element: user
        relationship: connected to
        target_data_element: port
      - source_data_element: user
        relationship: connected to
        target_data_element: ip
      - source_data_element: user
        relationship: connected to
        target_data_element: host
      - source_data_element: user
        relationship: connected from
        target_data_element: port
      - source_data_element: user
        relationship: connected from
        target_data_element: ip
      - source_data_element: user
        relationship: connected from
        target_data_element: host
      - source_data_element: host
        relationship: blocked connection on #TBD - wouldn't this and other blocked/allowed relationships make more sense for a firewall data source?
        target_data_element: process
      - source_data_element: host
        relationship: blocked connection to
        target_data_element: process
      - source_data_element: host
        relationship: blocked connection to
        target_data_element: ip
      - source_data_element: host
        relationship: blocked connection to
        target_data_element: port
      - source_data_element: host
        relationship: blocked connection from
        target_data_element: process
      - source_data_element: host
        relationship: blocked connection from
        target_data_element: ip
      - source_data_element: host
        relationship: blocked connection from
        target_data_element: port
      - source_data_element: process
        relationship: attempted connection to
        target_data_element: ip
      - source_data_element: process
        relationship: attempted connection to
        target_data_element: port
      - source_data_element: process
        relationship: attempted connection from
        target_data_element: ip
      - source_data_element: process
        relationship: attempted connection from
        target_data_element: port
      - source_data_element: host
        relationship: permitted listener on
        target_data_element: process
      - source_data_element: host
        relationship: permitted listener on
        target_data_element: ip
      - source_data_element: host
        relationship: permitted listener on
        target_data_element: port
      - source_data_element: process
        relationship: listened on
        target_data_element: port
      - source_data_element: host
        relationship: blocked listener on
        target_data_element: process
      - source_data_element: host
        relationship: blocked listener on
        target_data_element: ip
      - source_data_element: host
        relationship: blocked listener on
        target_data_element: port
      - source_data_element: process
        relationship: attempted to listen on
        target_data_element: port
      - source_data_element: host
        relationship: permitted local port bind on
        target_data_element: process
      - source_data_element: host
        relationship: permitted local port bind on
        target_data_element: ip
      - source_data_element: host
        relationship: permitted local port bind on
        target_data_element: port
      - source_data_element: process
        relationship: bound to
        target_data_element: port
      - source_data_element: host
        relationship: blocked local port bind on
        target_data_element: process
      - source_data_element: host
        relationship: blocked local port bind on
        target_data_element: ip
      - source_data_element: host
        relationship: blocked local port bind on
        target_data_element: port
      - source_data_element: process
        relationship: attempted to bind on
        target_data_element: port
references:
  - https://docs.microsoft.com/en-us/windows/win32/procthread/processes-and-threads
